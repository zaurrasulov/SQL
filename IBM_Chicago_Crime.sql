/* The table for the Crime is creating*/
CREATE TABLE CRIME (
ID INTEGER PRIMARY KEY,
CASE_NUMBER VARCHAR(200),
DATE1 DATE,
BLOCK VARCHAR(200),
IUCR INTEGER,
PRIMARY_TYPE VARCHAR(200),
DESCRIPTION1 VARCHAR(200),
LOCATION_DESCRIPTION VARCHAR(200),
ARREST VARCHAR(200),
DOMESTIC VARCHAR(200),
BEAT INTEGER,
DISTRICT INTEGER NOT NULL,
WARD INTEGER,
COMMUNITY_AREA_NUMBER INTEGER,
FBICODE INTEGER,
X_COORDINATE INTEGER,
Y_COORDINATE INTEGER, 
YEAR1 INTEGER,
LATITUDE FLOAT,
LONGITUDE FLOAT
)


/*The values are entered to the table
P.S. As an example only 11 data are entered*/
INSERT INTO CRIME(ID, CASE_NUMBER, DATE1, BLOCK, IUCR, PRIMARY_TYPE, DESCRIPTION1, LOCATION_DESCRIPTION, ARREST, DOMESTIC, BEAT, DISTRICT, WARD, COMMUNITY_AREA_NUMBER, FBICODE, X_COORDINATE, Y_COORDINATE, YEAR1, LATITUDE, LONGITUDE) 
INSERT INTO CRIME VALUES(3512276, 'HK587712', '08/28/2004 05:50:56 PM', '047XX S KEDZIE AVE', 890, 'THEFT', 'FROM BUILDING', 'SMALL RETAIL STORE', 'FALSE', 'FALSE', 911, 9, 14, 58, 6, 1155838, 1873050, 2004,	41.8074405, -87.70395585)
INSERT INTO CRIME VALUES(3406613, 'HK456306', '06/26/2004 12:40:00 PM', '009XX N CENTRAL PARK AVE', 820, 'THEFT', '$500 AND UNDER', 'OTHER', 'FALSE', 'FALSE', 1112, 11, 27, 23, 6, 1152206, 1906127, 2004, 41.89827996, -87.71640551)
INSERT INTO CRIME VALUES(8002131, 'HT233595', '04/04/2011 05:45', '043XX S WABASH AVE', 820, 'THEFT', '$500 AND UNDER',	'NURSING HOME/RETIREMENT HOME', 'FALSE', 'FALSE', 221,	2, 3, 38, 6, 1177436, 1876313, 2011, 41.81593313,-87.62464213)
INSERT INTO CRIME VALUES(7903289, 'HT133522', '12/30/2010 04:30:00 PM','083XX S KINGSTON AVE', 840, 'THEFT', 'FINANCIAL ID THEFT: OVER $300', 'RESIDENCE', 'FALSE', 'FALSE', 423, 4, 7, 46, 6, 1194622,	1850125, 2010,	41.74366532,-87.56246276)
INSERT INTO CRIME VALUES(10402076, 'HZ138551', '02/02/2016 19:30', '033XX W 66TH ST',	820, 'THEFT', '$500 AND UNDER',	'ALLEY', 'FALSE','FALSE',831, 8, 15, 66, 6, 1155240, 1860661, 2016, 41.7734553,	-87.70648047)
INSERT INTO CRIME VALUES(7732712, 'HS540106', '09/29/2010 07:59:00 AM', '006XX W CHICAGO AVE', 810, 'THEFT', 'OVER $500', 'PARKING LOT/GARAGE(NON.RESID.)', 'FALSE', 'FALSE', 1323, 12, 27, 24, 6, 1171668, 1905607, 2010, 41.89644677, -87.64493868)
INSERT INTO CRIME VALUES(10769475, 'HZ534771', '11/30/2016 01:15:00 AM', '050XX N KEDZIE AVE', 810, 'THEFT', 'OVER $500', 'STREET', 'FALSE',	'FALSE', 1713,	17, 33, 14, 6, 1154133,	1933314, 2016,	41.97284491, -87.70860008)
INSERT INTO CRIME VALUES(4494340, 'HL793243', '12/16/2005 04:45:00 PM', '005XX E PERSHING RD', 860, 'THEFT', 'RETAIL THEFT', 'GROCERY FOOD STORE', 'TRUE', 'FALSE', 213, 2, 3, 38, 6, 1180448, 1879234, 2005, 41.82387989, -87.61350386)
INSERT INTO CRIME VALUES(3778925, 'HL149610', '01/28/2005 05:00:00 PM', '100XX S WASHTENAW AVE',810, 'THEFT',	'OVER $500', 'STREET',	'FALSE', 'FALSE', 2211,	22, 19,	72, 6,	1160129, 1838040, 2005, 41.71128051, -87.6891791)
INSERT INTO CRIME VALUES(7505841, 'HS308747', '05/15/2010 09:15:00 AM',	'004XX E 95TH ST', 890, 'THEFT', 'FROM BUILDING', 'GAS STATION', 'FALSE', 'FALSE',633, 6, 9, 49, 6, 1180667, 1842071, 2010, 41.72189586, -87.61384102)
INSERT INTO CRIME VALUES(4153041, 'HL005270', '07/12/2005 23:00', '008XX N CICERO AVE',	820, 'THEFT', '$500 AND UNDER',	'GAS STATION',	'FALSE', 'FALSE', 1111,	11, 37,	25, 6, 1144207, 1904963, 2005, 41.8952399, -87.74581479)

/* Seeing all the elements from the table*/
SELECT * 
FROM CRIME

/* Finding the total amount of crimes.*/
SELECT COUNT(PRIMARY_TYPE)
FROM CRIME

/* Selecting all from the Crime*/
SELECT * 
FROM CRIME

/* Selecting all with IUCR = 820*/
SELECT * 
FROM CRIME
WHERE IUCR = 820

/* Selecting all where Arrest = True*/
SELECT *
FROM CRIME
WHERE ARREST = 'TRUE'

SELECT *
FROM CRIME
WHERE LOCATION_DESCRIPTION = 'GAS STATION'


CREATE TABLE CENSUS_DATA(
COMMUNITY_AREA_NUMBER INTEGER,
COMMUNITY_AREA_NAME VARCHAR(200), 
PERCENT_OF_HOUSING_CROWDED FLOAT,
PERCENT_HOUSEHOLDS_BELOW_POVERTY FLOAT,
PERCENT_AGED_16_UNEMPLOYED FLOAT,
PERCENT_AGED_25_WITHOUT_HIGH_SCHOOL_DIPLOMA FLOAT,
PERCENT_AGED_UNDER_18_OR_OVER_64 FLOAT, 
PER_CAPITA_INCOME INTEGER,
HARDSHIP_INDEX INTEGER
)


/*INSERT INTO CENSUS_DATA(COMMUNITY_AREA_NUMBER, COMMUNITY_AREA_NAME, PERCENT_OF_HOUSING_CROWDED, PERCENT_OF_HOUSEHOLDS_BELOW_POWERTY, PERCENT_AGED_16_UNEMPLOYED, PERCENT_AGED_25_WITHOUT_HIGH_SCHOOL_DIPLOMA, PERCENT_AGED_UNDER_18_OR_OVER_64, PER_CAPITA_INCOME, HARDSHIP_INDEX)*/
INSERT INTO CENSUS_DATA VALUES(1, 'Rogers Park', 7.7, 23.6, 8.7, 18.2, 27.5, 23939, 39)
INSERT INTO CENSUS_DATA VALUES(2, 'West Ridge',	7.8, 17.2, 8.8,	20.8, 38.5, 23040, 46)
INSERT INTO CENSUS_DATA VALUES(3, 'Uptown', 3.8, 24, 8.9, 11.8, 22.2, 35787, 20)
INSERT INTO CENSUS_DATA VALUES(4, 'Lincoln Square', 3.4, 10.9, 8.2, 13.4, 25.5,	37524,	17)
INSERT INTO CENSUS_DATA VALUES(5, 'North Center', 0.3, 7.5, 5.2, 4.5, 26.2, 57123, 6)
INSERT INTO CENSUS_DATA VALUES(6, 'Lake View',	1.1, 11.4, 4.7, 2.6, 17, 60058, 5)
INSERT INTO CENSUS_DATA VALUES(7, 'Lincoln Park', 0.8, 12.3, 5.1, 3.6, 21.5, 71551, 2)
INSERT INTO CENSUS_DATA VALUES(8, 'Near North Side', 1.9, 12.9,	7, 2.5,	22.6, 88669, 1)
INSERT INTO CENSUS_DATA VALUES(9, 'Edison Park', 1.1, 3.3, 6.5, 7.4, 35.3, 40959, 8)
INSERT INTO CENSUS_DATA VALUES(10, 'Norwood Park', 2, 5.4, 9, 11.5, 39.5, 32875, 21)
INSERT INTO CENSUS_DATA VALUES(11, 'Jefferson Park', 2.7, 8.6, 12.4, 13.4, 35.5, 27751,	25)
INSERT INTO CENSUS_DATA VALUES(19, 'Belmont Cragin', 10.8, 18.7, 14.6, 37.3, 37.3, 15461, 70)

/* Select the data from CENSUS_DATA in which the community area name starts with 'B'*/
SELECT *
FROM CENSUS_DATA
WHERE COMMUNITY_AREA_NAME LIKE 'B%'
	
/* Create table Public_school*/
CREATE TABLE PUBLIC_SCHOOL(
SCHOOL_ID INTEGER,
NAME_OF_SCHOOL VARCHAR(200),
HEALTH_SCHOOL_CERTIFIED VARCHAR(3),
SAFETY_SCORE INTEGER,
COLLEGE_ENROLLMENT INTEGER,
COMMUNITY_AREA_NUMBER INTEGER,
COMMUNITY_AREA_NAME VARCHAR(200)
)

/* Insert 10 values*/
INSERT INTO PUBLIC_SCHOOL VALUES(610038, 'Abraham Lincoln Elementary School', 'Yes', 99, 813, 7, 'LINCOLN PARK')
INSERT INTO PUBLIC_SCHOOL VALUES(610281, 'Adam Clayton Powell Paideia Community Academy Elementary School', 'No', 54, 521, 43, 'SOUTH SHORE')
INSERT INTO PUBLIC_SCHOOL VALUES(610185, 'Adlai E Stevenson Elementary School',	'No', 61, 1324,	70, 'ASHBURN')
INSERT INTO PUBLIC_SCHOOL VALUES(609993, 'Agustin Lara Elementary Academy', 'No', 56, 556, 61, 'NEW CITY')
INSERT INTO PUBLIC_SCHOOL VALUES(610513, 'Air Force Academy High School', 'Yes', 49, 302, 34, 'ARMOUR SQUARE')
INSERT INTO PUBLIC_SCHOOL VALUES(610212, 'Albany Park Multicultural Academy', 'No', 66,	266, 14, 'ALBANY PARK')
INSERT INTO PUBLIC_SCHOOL VALUES(609720, 'Albert G Lane Technical High School', 'No', 88, 4368,	5, 'NORTH CENTER')
INSERT INTO PUBLIC_SCHOOL VALUES(610342, 'Albert R Sabin Elementary Magnet School', 'No', 67,	620, 24, 'WEST TOWN')
INSERT INTO PUBLIC_SCHOOL VALUES(610524, 'Alcott High School for the Humanities', 'No',	70, 232, 5, 'NORTH CENTER')
INSERT INTO PUBLIC_SCHOOL VALUES(610209, 'Alessandro Volta Elementary School', 'No', 43, 1023, 14, 'ALBANY PARK')

/* Calculate the safety score average*/
SELECT AVG(SAFETY_SCORE)
FROM PUBLIC_SCHOOL

/* Select the maximum values of safety_score*/
SELECT MAX(SAFETY_SCORE), MAX(COLLEGE_ENROLLMENT)
FROM PUBLIC_SCHOOL
/* Select the school with the maximum safety score*/
SELECT NAME_OF_SCHOOL
FROM PUBLIC_SCHOOL
WHERE SAFETY_SCORE = (SELECT MAX(SAFETY_SCORE)
			FROM PUBLIC_SCHOOL)

/* Select the school with the minimum college enrollment number*/
SELECT NAME_OF_SCHOOL
FROM PUBLIC_SCHOOL
WHERE COLLEGE_ENROLLMENT = (SELECT MIN(COLLEGE_ENROLLMENT)
			    FROM PUBLIC_SCHOOL)

/* Calculate the average college enrollment number*/
SELECT AVG(COLLEGE_ENROLLMENT)
FROM PUBLIC_SCHOOL

/* List the top 5 Community Areas by average College Enrollments*/
SELECT TOP 5 AVG(COLLEGE_ENROLLMENT)
FROM PUBLIC_SCHOOL
GROUP BY COMMUNITY_AREA_NAME

/* Select the Community Area with the least value for safety score*/ 
SELECT COMMUNITY_AREA_NAME
FROM PUBLIC_SCHOOL
WHERE SAFETY_SCORE = (SELECT MIN(SAFETY_SCORE)
			FROM PUBLIC_SCHOOL)
